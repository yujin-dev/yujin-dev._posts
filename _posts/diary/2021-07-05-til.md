---
title: "21.07.05"
category: "til"
---
## [ PostgreSQL ] NUMERIC data type
출처: https://www.geeksforgeeks.org/postgresql-numeric-data-type/

postgresql에서  `NUMERIC` type이 지원된다. syntax는 아래와 같다. 

```sql
NUMERIC(precision, scale)

/*
Precision: 전체 숫자 길이
Scale: fraction( 소숫점 )의 길이
*
```
예를 들어,

```sql
CREATE TABLE IF NOT EXISTS products (
    id serial PRIMARY KEY,
    name VARCHAR NOT NULL,
    price NUMERIC (5, 2)
);
```
테이블을 생성하면, 아래와 같은 데이터를 삽입할 때
```sql
INSERT INTO products (name, price)
VALUES
    ('Phone', 100.2157), 
    ('Tablet', 300.2149);
```
[ 결과 ]
```sql
id | name  | price
-------------------
 1 | Phone | 100.22
 2 | Table | 300.21
```
전체 길이 5에서 소숫점 2만큼만 반영된다.

---
## [ PostgreSQL ] inner join vs. pandas.merge(how='inner')
Postgresql 서버에서 inner join을 적용하는게 나을지, python에서 데이터를 메모리에 올려 `pandas.merge`로 적용하는게 나을지 실험해보았다. 데이터를 전구간으로 한번에 쿼리 요청하면 프로세스가 죽어있는 경우가 발생하여 연도별로 나눠서 받았다.

[ 21.07.14 추가 ]
결과를 정리하면, 
- 기존에 병합이 필요한 부분은 `pd.merge`를 적용하였는데 약 1~2 GB 데이터 받는데 대략 4060초 소요되었음. 
- `pd.merge` 대신 PostgreSQL에서 대신 쿼리로 작업을 수행하여 `inner join`을 적용하였는데 9172초로 대략 2배 더 발생했음. 
