---
title: "21.07.01"
category: "til"
---

## [ PostgreSQL ] Lock 파악하기
스크랩 : https://medium.com/29cm/db-postgresql-lock-%ED%8C%8C%ED%97%A4%EC%B9%98%EA%B8%B0-57d37ebe057

## [ PostgreSQL ] Connection Pool deadlock 현상

PostgreSQL 서버의 최대 connection 갯수는 크게 설정되지 않고 client에서 무거운 transaction으로 인한 *connection pool deadlock*이 발생하기 쉽다. 
초창기에 무거운 transaction으로 인해 pool에 deadlock이 걸려 서비스 장애가 일어날 수 있다. pool size를 늘리고 무거운 transaction은 한번에 처리할 수 있도록 최대 갯수를 늘려 deadlock을 방지할 수 있으나 서비스 응답시간과 connection 사용량에 문제가 생긴다. 

해결 방안 제시 : https://medium.com/@hyeonjay.kim/postgresql-%EC%B4%88%EB%B3%B4%EB%A5%BC-%EC%9C%84%ED%95%9C-%EA%B0%80%EC%9D%B4%EB%93%9C-%EC%BF%BC%EB%A6%AC-%EC%BB%A4%EB%84%A5%EC%85%98-%ED%92%80-%EA%B7%B8%EB%A6%AC%EA%B3%A0-%EC%84%9C%EB%B9%84%EC%8A%A4-%EC%9D%91%EB%8B%B5%EC%8B%9C%EA%B0%84-%EC%B5%9C%EC%A0%81%ED%99%94%ED%95%98%EA%B8%B0-917352a2a19a