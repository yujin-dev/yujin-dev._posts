---
title: "Recommend System Lecture Note(3)"
category: "recommend"
---
3주차 강의의 key word 는 아래와 같다. 
- 모델 기반 협업 필터링
- Latent Factor Model & SVD
- Matrix Factorization
- BPR Optimization with MF
- Annoy

## 3-1. Collaborative Filtering
Collaborative Filtering은 크게 다음과 같이 분류된다.
#### **Neighborhood-based CF**
메모리 기반 CF. 유저/아이템 간의 유사도에 크게 의존하는 기법이다. 데이터의 sparsity에 취약하다.
- User-based : 유저간 유사도를 통해 연관도 높은 유저의 선호 아이템 추천
- Item-based : 아이템간 유사도를 통해 연관성 높은 아이템 추천

#### **Model-based CF**
모델 기반의 CF. Parametric ML를 사용하여 모델의 파라미터는 데이터 정보로 구성되고 파라미터를 업데이트하여 최적화한다.
- Singular Value Decomposition
- Matrix Factorization( SGD, ALS, BPR )
- Probabilistic Model
- DL

#### **Hybird CF**
- Content-based Recommendation과 결합.

Neighborhood-based CF 에서 유저/아이템 벡터는 데이터가 고정되어 사용되지만 Model-based CF는 유저/아이템 벡터가 업데이트되는 벡터로 데이터가 모델 학습에만 사용된다. 

## 3-2. Latent Factor Model & SVD

### Latent Factor Model
Latent Factor Model는 유저와 아이템을 벡터로 압축하여 잠재 요인으로 표현하는 모델이다. 유저와 아이템을 여러 차원의 벡터로 나타내어 각각의 유사도를 확인할 수 있다. 

### Single Value Decomposition(SVD)

Rating Matrix *R*에 대해 유저와 아이템의 어떤 matrix로 분해한다.  
![](https://oopy.lazyrockets.com/api/v2/notion/image?src=https%3A%2F%2Fs3-us-west-2.amazonaws.com%2Fsecure.notion-static.com%2Fcb22c772-b4b7-4078-acb1-8761c486a4bc%2FUntitled.png&blockId=a8bfc1be-82df-40f1-814a-53b82ab0611f
)

Truncated SVD는 대표값으로 사용되는 k개의 특이값만 사용한다.    
![](https://www.researchgate.net/publication/323907837/figure/fig2/AS:606612796473344@1521639169497/Schematic-representation-for-singular-value-decomposition-SVD-analysis.png)

하지만 SVD는 분해하는 matrix의 정보가 불완전하면 정의될 수 없기에 entry를 모두 채우는 imputation을 적용한다. 이는 데이터를 왜곡시키고 계산량을 증가시키는 단점이 있다.

## Matrix Factorization
MF는 user matrix, item matrix 2개로 이루어진다.  
![](https://miro.medium.com/max/5130/1*b4M7o7W8bfRRxdMxtFoVBQ.png)

Rating matrix의 objective는 실제 *R* matrix와 예측치가 최대한 유사하도록 loss를 줄이는 것이다. 학습방식은 stochastic gradient descent에 따라 weight를 업데이트하는 과정에 따른다.   
![](https://miro.medium.com/max/1400/0*1SFw18gXgdSRsa8N)

SVD와 다르게 실측 데이터만을 대상으로 하여 결측치를 채워줄 필요가 없다. 람다를 넣어 L2 정규화를 포함시켜 weight를 조정하여 오버피팅을 방지한다.

#### Adding Biases


※ 강의노트는 러닝 스푼즈의 추천시스템 구현하기 수업을 듣고 정리한 내용이다. 